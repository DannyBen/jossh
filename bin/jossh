#!/usr/bin/env ruby

require 'jossh'

# for dev (not needed in most cases)
# require File.dirname(__FILE__) + "/../lib/jossh"

trap(:INT) { abort "\r\nGoodbye" }

def usage
  "\nUsage: jossh <host> <script>\n\n" +
  " <host>   - any key available in ./ssh_hosts.yml\n" +
  " <script> - can be either a filename or one or more direct command\n" + 
  "            quotes are only needed if you include multiple commands\n" + 
  "            with && or semicolor (;)\n\n" +
  "Examples: jossh localhost git status\n" +
  "          jossh localhost \"cd ~ && ls -l\"\n" +
  "          jossh localhost deploy"
end

def run
  host = ARGV.shift
  script = ARGV.join ' '
  host and script or abort usage
  if File.exist? script
    ssh_script! host.to_sym, script
  else
    ssh host.to_sym, script
  end
end

run
